import os
import pandas as pd

def generate_yoy_report(path_detail):
    # Define years
    years = [2023, 2024, 2025]
    data = {}

    # Read all 3 yearly CSVs
    for yr in years:
        file = f"{path_detail}/data_{yr}.csv"
        if os.path.exists(file):
            df = pd.read_csv(file, header=None, names=[f"DATE_{yr}", str(yr)])
            data[yr] = df
        else:
            print(f"⚠️ Missing file: {file}")
            return None

    # Merge side-by-side based on row position (not on DATE)
    merged = pd.concat([data[2023], data[2024], data[2025]], axis=1)

    # Save merged report
    output_file = f"{path_detail}/YoY_Comparison_Report.csv"
    merged.to_csv(output_file, index=False)

    print(f"✅ YoY comparison report created successfully at: {output_file}")
    return merged
